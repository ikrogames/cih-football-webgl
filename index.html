<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="utf-8" />
    <title>Unity WebGL Player | Africa Football Legends</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico" />

    <!-- Firebase SDK (compat version) -->
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.14.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyB0qaD4Ct5cp3Wjcp1485ij8gSfLVf44dY",
            authDomain: "cih-football.firebaseapp.com",
            projectId: "cih-football",
            storageBucket: "cih-football.firebasestorage.app",
            messagingSenderId: "718160665278",
            appId: "1:718160665278:web:524d891d0de2aa69121cef",
            measurementId: "G-34EH7DVHBH",
        };
        const firebaseApp = firebase.initializeApp(firebaseConfig);
        const auth = firebaseApp.auth();
    </script>

    <style>
        html, body {
            margin: 0;
            height: 100%;
            background: #231F20;
            overflow: hidden;
        }

        /* Unity container */
        #unity-container {
            width: 100vw; height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background: #231F20;
        }

        #unity-canvas {
            background: #231F20;
        }

        /* Custom loading screen */
        #Chargement {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            font-family: sans-serif;
            transition: opacity 0.5s ease;
            z-index: 10;
        }
        #Chargement img {
            width: 250px; max-width: 70%; height: auto;
            display: block; margin: 0 auto;
        }
        #Chargement p {
            margin-top: 20px;
        }

        /* Rotate warning for portrait */
        #rotate-warning {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: #231F20;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-family: sans-serif;
            z-index: 20;
            text-align: center;
            padding: 20px;
        }

        /* Mobile full screen (DISABLED) */
        #unity-container.unity-mobile,
        #unity-canvas.unity-mobile {
            width: 100vw; height: 100vh; display: block;
        }
    </style>
</head>
<body>
<div id="unity-container" class="unity-desktop">
    <!-- Unity canvas -->
    <canvas id="unity-canvas" width="960" height="600" tabindex="-1"></canvas>

    <!-- Custom loading -->
    <div id="Chargement">
        <img src="logo.png" alt="Studio Logo">
        <p>Chargement...</p>
    </div>
</div>

<!-- Rotate warning -->
<div id="rotate-warning">Veuillez tourner votre t√©l√©phone en mode paysage</div>

<script>
    const container = document.getElementById("unity-container");
    const canvas = document.getElementById("unity-canvas");
    const loading = document.getElementById("Chargement");
    const rotateWarning = document.getElementById("rotate-warning");

    // Build paths
    const buildUrl = "Build";
    const loaderUrl = buildUrl + "/Africa Football Legends.loader.js";
    const config = {
        dataUrl: buildUrl + "/Africa Football Legends.data",
        frameworkUrl: buildUrl + "/Africa Football Legends.framework.js",
        codeUrl: buildUrl + "/Africa Football Legends.wasm",
        streamingAssetsUrl: "StreamingAssets",
        companyName: "Ikro Games",
        productName: "Africa Football Legends",
        productVersion: "1.0",
    };

    // Mobile detection
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    if (isMobile) {
        const meta = document.createElement("meta");
        meta.name = "viewport";
        meta.content = "width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes";
        document.head.appendChild(meta);

        // üî¥ Removed fullscreen forcing on mobile
        // container.classList.remove("unity-desktop");
        // container.classList.add("unity-mobile");
        // canvas.classList.add("unity-mobile");
    } else {
        // Desktop fixed size and centered
        canvas.style.width = "960px";
        canvas.style.height = "600px";
    }

    // Orientation lock ‚Üí landscape only on mobile
    function checkOrientation() {
        if (isMobile) {
            if (window.innerHeight > window.innerWidth) {
                // Portrait ‚Üí show warning
                rotateWarning.style.display = "flex";
                container.style.display = "none";
            } else {
                // Landscape ‚Üí show game
                rotateWarning.style.display = "none";
                container.style.display = "flex";
            }
        }
    }
    window.addEventListener("resize", checkOrientation);
    checkOrientation();

    // Load Unity
    const script = document.createElement("script");
    script.src = loaderUrl;
    script.onload = () => {
        createUnityInstance(canvas, config).then((unityInstance) => {
            window.unityInstance = unityInstance;
            loading.style.opacity = 0;
            setTimeout(() => loading.style.display = "none", 500);
        }).catch((message) => {
            alert(message);
        });
    };
    document.body.appendChild(script);
</script>
</body>
</html>
